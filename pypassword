#!/usr/bin/python
import sys, getopt,argparse,time


keyword = 'None'
pattern = [".","?","!","$","#","123","2015","15","2014","14","1234","12345","123456",'.?', '.!', '.$', '.#', '.123', '.2015', '.15', '.2014', '.14', '.1234', '.12345', '.123456', '?.', '?!', '?$', '?#', '?123', '?2015', '?15', '?2014', '?14', '?1234', '?12345', '?123456', '!.', '!?', '!$', '!#', '!123', '!2015', '!15', '!2014', '!14', '!1234', '!12345', '!123456', '$.', '$?', '$!', '$#', '$123', '$2015', '$15', '$2014', '$14', '$1234', '$12345', '$123456', '#.', '#?', '#!', '#$', '#123', '#2015', '#15', '#2014', '#14', '#1234', '#12345', '#123456', '123.', '123?', '123!', '123$', '123#', '1232015', '12315', '1232014', '12314',  '2015.', '2015?', '2015!', '2015$', '2015#', '2015123',  '20151234', '201512345', '2015123456', '15.', '15?', '15!', '15$', '15#', '15123',   '151234', '1512345', '15123456', '2014.', '2014?', '2014!', '2014$', '2014#', '2014123',  '20141234', '201412345', '2014123456', '14.', '14?', '14!', '14$', '14#', '14123',   '141234', '1412345', '14123456', '1234.', '1234?', '1234!', '1234$', '1234#', '1234123', '12342015', '123415', '12342014', '123414', '12345.', '12345?', '12345!', '12345$', '12345#', '123452015', '1234515', '123452014', '1234514', '123456.', '123456?', '123456!', '123456$', '123456#', '123456123', '1234562015', '12345615', '1234562014','.?.',  '.?!', '.?$', '.?#', '.?123', '.!.', '.!?',  '.!$', '.!#', '.!123', '.$.', '.$?', '.$!',  '.$#', '.$123', '.#.', '.#?', '.#!', '.#$', '.#123', '.123.', '.123?', '.123!', '.123$', '.123#',  '.2015.', '.2015?', '.2015!', '.2015$', '.2015#', '.2015123', '.15.', '.15?', '.15!', '.15$', '.15#', '.15123', '.2014.', '.2014?', '.2014!', '.2014$', '.2014#', '.2014123', '.14.', '.14?', '.14!', '.14$', '.14#', '.14123', '.1234.', '.1234?', '.1234!', '.1234$', '.1234#', '.1234123', '.12345.', '.12345?', '.12345!', '.12345$', '.12345#',  '.123456.', '.123456?', '.123456!', '.123456$', '.123456#',  '?.?', '?.!', '?.$', '?.#', '?.123', '?!.', '?!?',  '?!$', '?!#', '?!123', '?$.', '?$?', '?$!',  '?$#', '?$123', '?#.', '?#?', '?#!', '?#$',  '?#123', '?123.', '?123?', '?123!', '?123$', '?123#', '?123123', '?2015.', '?2015?', '?2015!', '?2015$', '?2015#', '?2015123', '?15.', '?15?', '?15!', '?15$', '?15#', '?15123', '?2014.', '?2014?', '?2014!', '?2014$', '?2014#', '?2014123', '?14.', '?14?', '?14!', '?14$', '?14#', '?14123', '?1234.', '?1234?', '?1234!', '?1234$', '?1234#', '?1234123', '?12345.', '?12345?', '?12345!', '?12345$', '?12345#', '?12345123', '?123456.', '?123456?', '?123456!', '?123456$', '?123456#', '?123456123',  '!.?', '!.!', '!.$', '!.#', '!.123', '!?.',  '!?!', '!?$', '!?#', '!?123', '!$.', '!$?', '!$!',  '!$#', '!$123', '!#.', '!#?', '!#!', '!#$',  '!#123', '!123.', '!123?', '!123!', '!123$', '!123#', '!123123', '!2015.', '!2015?', '!2015!', '!2015$', '!2015#', '!2015123', '!15.', '!15?', '!15!', '!15$', '!15#', '!15123', '!2014.', '!2014?', '!2014!', '!2014$', '!2014#', '!2014123', '!14.', '!14?', '!14!', '!14$', '!14#', '!14123', '!1234.', '!1234?', '!1234!', '!1234$', '!1234#', '!1234123', '!12345.', '!12345?', '!12345!', '!12345$', '!12345#', '!12345123', '!123456.', '!123456?', '!123456!', '!123456$', '!123456#', '!123456123',  '$.?', '$.!', '$.$', '$.#', '$.123', '$?.',  '$?!', '$?$', '$?#', '$?123', '$!.', '$!?', '$!$', '$!#', '$!123', '$#.', '$#?', '$#!', '$#$',  '$#123', '$123.', '$123?', '$123!', '$123$', '$123#', '$123123', '$2015.', '$2015?', '$2015!', '$2015$', '$2015#', '$2015123', '$15.', '$15?', '$15!', '$15$', '$15#', '$15123', '$2014.', '$2014?', '$2014!', '$2014$', '$2014#', '$2014123', '$14.', '$14?', '$14!', '$14$', '$14#', '$14123', '$1234.', '$1234?', '$1234!', '$1234$', '$1234#', '$1234123', '$12345.', '$12345?', '$12345!', '$12345$', '$12345#', '$12345123', '$123456.', '$123456?', '$123456!', '$123456$', '$123456#', '$123456123',  '#.?', '#.!', '#.$', '#.#', '#.123', '#?.', '#?!', '#?$', '#?#', '#?123', '#!.', '#!?',  '#!$', '#!#', '#!123', '#$.', '#$?', '#$!',  '#$#', '#$123', '#123.', '#123?', '#123!', '#123$', '#123#', '#123123', '#2015.', '#2015?', '#2015!', '#2015$', '#2015#', '#2015123', '#15.', '#15?', '#15!', '#15$', '#15#', '#15123', '#2014.', '#2014?', '#2014!', '#2014$', '#2014#', '#2014123', '#14.', '#14?', '#14!', '#14$', '#14#', '#14123', '#1234.', '#1234?', '#1234!', '#1234$', '#1234#', '#1234123', '#12345.', '#12345?', '#12345!', '#12345$', '#12345#', '#12345123', '#123456.', '#123456?', '#123456!', '#123456$', '#123456#', '#123456123',  '123.?', '123.!', '123.$', '123.#', '123.123', '123?.',  '123?!', '123?$', '123?#', '123?123', '123!.', '123!?',  '123!$', '123!#', '123!123', '123$.', '123$?', '123$!',  '123$#', '123$123', '123#.', '123#?', '123#!', '123#$',  '123#123', '1232015.', '1232015?', '1232015!', '1232015$', '1232015#', '1232015123', '12315.', '12315?', '12315!', '12315$', '12315#', '12315123', '1232014.', '1232014?', '1232014!', '1232014$', '1232014#', '1232014123', '12314.', '12314?', '12314!', '12314$', '12314#', '12314123', '1231234.', '1231234?', '1231234!', '1231234$', '1231234#', '1231234123', '12312345.', '12312345?', '12312345!', '12312345$', '12312345#', '12312345123', '123123456.', '123123456?', '123123456!', '123123456$', '123123456#' '2015.?', '2015.!', '2015.$', '2015.#', '2015.123', '2015?.',  '2015?!', '2015?$', '2015?#', '2015?123', '2015!.', '2015!?',  '2015!$', '2015!#', '2015!123', '2015$.', '2015$?', '2015$!',  '2015$#', '2015$123', '2015#.', '2015#?', '2015#!', '2015#$',  '2015#123', '2015123.', '2015123?', '2015123!', '2015123$', '2015123#', '2015123123', '20151234.', '20151234?', '20151234!', '20151234$', '20151234#', '20151234123', '201512345.', '201512345?', '201512345!', '201512345$', '201512345#', '201512345123', '2015123456.', '2015123456?', '2015123456!', '2015123456$', '2015123456#', '2015123456123',  '15.?', '15.!', '15.$', '15.#', '15.123', '15?.',  '15?!', '15?$', '15?#', '15?123', '15!.', '15!?',  '15!$', '15!#', '15!123', '15$.', '15$?', '15$!',  '15$#', '15$123', '15#.', '15#?', '15#!', '15#$',  '15#123', '15123.', '15123?', '15123!', '15123$', '15123#', '15123123', '151234.', '151234?', '151234!', '151234$', '151234#', '151234123', '1512345.', '1512345?', '1512345!', '1512345$', '1512345#', '1512345123', '15123456.', '15123456?', '15123456!', '15123456$', '15123456#', '15123456123',  '2014.?', '2014.!', '2014.$', '2014.#', '2014.123', '2014?.',  '2014?!', '2014?$', '2014?#', '2014?123', '2014!.', '2014!?',  '2014!$', '2014!#', '2014!123', '2014$.', '2014$?', '2014$!',  '2014$#', '2014$123', '2014#.', '2014#?', '2014#!', '2014#$',  '2014#123', '2014123.', '2014123?', '2014123!', '2014123$', '2014123#', '2014123123', '20141234.', '20141234?', '20141234!', '20141234$', '20141234#', '20141234123', '201412345.', '201412345?', '201412345!', '201412345$', '201412345#', '201412345123', '2014123456.', '2014123456?', '2014123456!', '2014123456$', '2014123456#', '2014123456123',  '14.?', '14.!', '14.$', '14.#', '14.123', '14?.',  '14?!', '14?$', '14?#', '14?123', '14!.', '14!?',  '14!$', '14!#', '14!123', '14$.', '14$?', '14$!',  '14$#', '14$123', '14#.', '14#?', '14#!', '14#$', '14#123', '14123.', '14123?', '14123!', '14123$', '14123#', '14123123', '141234.', '141234?', '141234!', '141234$', '141234#', '141234123', '1412345.', '1412345?', '1412345!', '1412345$', '1412345#', '1412345123', '14123456.', '14123456?', '14123456!', '14123456$', '14123456#', '14123456123',  '1234.?', '1234.!', '1234.$', '1234.#', '1234.123', '1234?.',  '1234?!', '1234?$', '1234?#', '1234?123', '1234!.', '1234!?',  '1234!$', '1234!#', '1234!123', '1234$.', '1234$?', '1234$!',  '1234$#', '1234$123', '1234#.', '1234#?', '1234#!', '1234#$',  '1234#123', '1234123.', '1234123?', '1234123!', '1234123$', '1234123#', '1234123123', '12342015.', '12342015?', '12342015!', '12342015$', '12342015#', '12342015123', '123415.', '123415?', '123415!', '123415$', '123415#', '123415123', '12342014.', '12342014?', '12342014!', '12342014$', '12342014#', '12342014123', '123414.', '123414?', '123414!', '123414$', '123414#', '123414123',  '12345.?', '12345.!', '12345.$', '12345.#', '12345.123', '12345?.', '12345?!', '12345?$', '12345?#', '12345?123', '12345!.', '12345!?',  '12345!$', '12345!#', '12345!123', '12345$.', '12345$?', '12345$!',  '12345$#', '12345$123', '12345#.', '12345#?', '12345#!', '12345#$',  '12345#123', '123452015.', '123452015?', '123452015!', '123452015$', '123452015#', '123452015123', '1234515.', '1234515?', '1234515!', '1234515$', '1234515#', '1234515123', '123452014.', '123452014?', '123452014!', '123452014$', '123452014#', '123452014123', '1234514.', '1234514?', '1234514!', '1234514$', '1234514#', '1234514123',  '123456.?', '123456.!', '123456.$', '123456.#', '123456.123', '123456?.',  '123456?!', '123456?$', '123456?#', '123456?123', '123456!.', '123456!?',  '123456!$', '123456!#', '123456!123', '123456$.', '123456$?', '123456$!',  '123456$#', '123456$123', '123456#.', '123456#?', '123456#!', '123456#$',  '123456#123', '123456123.', '123456123?', '123456123!', '123456123$', '123456123#', '123456123123', '1234562015.', '1234562015?', '1234562015!', '1234562015$', '1234562015#', '1234562015123', '12345615.', '12345615?', '12345615!', '12345615$', '12345615#', '12345615123', '1234562014.', '1234562014?', '1234562014!', '1234562014$', '1234562014#', '1234562014123']
modified_keywords = []

#This function changes source character into destination character
def modify(source,destination):
	
	count = 0
	for i in keyword:
		if(i == source or i == source.upper()):
			modified_keywords.append(keyword[:count] + str(destination) + keyword[count+1:] )
		count += 1
		
	

	
parser = argparse.ArgumentParser()
parser.add_argument("-u", "--upperlowercase", help="Change first character into uppercase, second character into lowercase and so on (Default is false)", action="store_true")
parser.add_argument("-l", "--loweruppercase", help="Change first character into lowercase, second character into uppercase and so on (Default is false)", action="store_true")
parser.add_argument("-p", "--prefix", help="Add patterns at the beginning of your keyword", action="store_true")
parser.add_argument("-s", "--suffix", help="Add patterns at the end of your keyword", action="store_true")
parser.add_argument("--output",nargs=1,type=str, help="Name your output file", default="['wordlist']")
parser.add_argument("Keyword", type=str, help="Keyword you want to use in your password list")
parser.add_argument("--change", nargs='*', help="Change character in the keyword with another characters. Example usage: ./pypassword password --change a 4 password->p4ssword")
parser.add_argument("--addpattern", nargs='*', help="Add pattern to the pattern list")
args = parser.parse_args()
file = ''
if args.output:
	file = str(args.output)[2:-2]
if args.addpattern:
	for i in xrange(len(args.addpattern)):
		pattern.append(args.addpattern[i])
		
		
if args.Keyword:
	
	keyword = args.Keyword
	modified_keywords.append(keyword)

if args.upperlowercase:
	modified_keywords.remove(keyword)
	s = list(keyword)
	for i in xrange(len(s)):
		if(i%2==0):
			s[i] = s[i].upper()
		
	s = "".join(s)
	keyword = s
	
	modified_keywords.append(keyword)
	

if args.loweruppercase:
	modified_keywords.remove(keyword)
	s = list(keyword)
	for i in xrange(len(s)):
		if(i%2!=0):
			s[i] = s[i].upper()
		
	s = "".join(s)
	keyword = s
	modified_keywords.append(keyword)
		
if args.change:
	
	#Iterate over command-line arguments, even numbers are source character, odd numbers are destination character
	for i in xrange(len(args.change)):
		
		if(i % 2 == 0 ):
			modify(str(args.change[i]),args.change[i+1])


		
with open(file, "wb") as myfile:
	if args.prefix:
	
		for i in modified_keywords:
			for j in pattern:
			
				myfile.write(j+i)
				myfile.write('\n')
				

			
	if args.suffix:
		for i in modified_keywords:
			for j in pattern:
		
					myfile.write(i+j)
					myfile.write('\n')
myfile.close()			
print 'Done ' + file + ' generated' 